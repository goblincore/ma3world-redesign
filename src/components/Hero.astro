---
interface Props {
  title?: string;
  subtitle?: string;
}

import LogoGlobe from './LogoGlobe.astro';

const { title = "Digital-first Design Agency", subtitle = "We craft immersive digital experiences" } = Astro.props;
---

<section class="relative h-screen w-full flex items-center justify-center overflow-hidden">

  
  <!-- Background Video/Image -->
  <div class="absolute inset-0">
    <video
      id="hero-video"
      autoplay
      muted
      loop
      playsinline
      poster="/graphics/yuaheader-placeholder.png"
      class="w-full h-full object-cover"
    >
      <source id="hero-video-source" src="/video/loopingyua.mp4" type="video/mp4" />
      <img 
        src="/graphics/yuaheader-placeholder.png" 
        alt="" 
        class="w-full h-full object-cover"
      />
    </video>
    <div class="absolute inset-0 bg-black/30"></div>
  </div>
  
  <!-- Content -->
  <div class="absolute bottom-12 left-6 md:bottom-16 md:left-12 z-10 w-full max-w-[85vw] md:max-w-[40vw]">
    <!-- Logo & Wireframe Globe -->
    <LogoGlobe logoColor="white" className="relative w-full h-auto" />
    <h1 class="sr-only">
      <span class="lang-en">{title}</span>
      <span class="lang-ja">デジタル・ファーストのデザイン・エージェンシー</span>
    </h1>
  </div>
  
  <!-- Scroll Indicator -->
  <div class="absolute bottom-12 right-6 md:right-12 flex flex-col items-center gap-4 z-20">
    <span class="text-[10px] tracking-[0.2em] uppercase text-white/60 vertical-text font-bold">
      <span class="lang-en">Scroll</span>
      <span class="lang-ja">スクロール</span>
    </span>
    <div class="w-px h-24 bg-gradient-to-b from-white/60 to-transparent relative overflow-hidden">
      <div class="absolute top-0 left-0 w-full h-1/2 bg-white scroll-line-anim"></div>
    </div>
  </div>
</section>

<style>
  .vertical-text {
    writing-mode: vertical-rl;
    text-orientation: mixed;
  }

  .scroll-line-anim {
    animation: scroll-line 2s cubic-bezier(0.76, 0, 0.24, 1) infinite;
  }

  @keyframes scroll-line {
    0% {
      transform: translateY(-100%);
    }
    50% {
      transform: translateY(200%);
    }
    100% {
      transform: translateY(200%);
    }
  }
</style>

<script>
  const video = document.getElementById('hero-video') as HTMLVideoElement;
  const source = document.getElementById('hero-video-source') as HTMLSourceElement;
  
  const updateVideoSource = () => {
    const isLight = document.documentElement.getAttribute('data-theme') === 'light';
    const newSrc = isLight ? '/video/lightloop2.mp4' : '/video/loopingyua.mp4';
    
    if (source && source.getAttribute('src') !== newSrc) {
      source.setAttribute('src', newSrc);
      video.load();
      video.play();
    }
  };

  // Initial check
  updateVideoSource();

  // Watch for theme changes
  const observer = new MutationObserver((mutations) => {
    mutations.forEach((mutation) => {
      if (mutation.type === 'attributes' && mutation.attributeName === 'data-theme') {
        updateVideoSource();
      }
    });
  });

  observer.observe(document.documentElement, {
    attributes: true,
    attributeFilter: ['data-theme']
  });
</script>
